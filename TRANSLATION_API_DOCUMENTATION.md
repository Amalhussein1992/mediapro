# Translation API Documentation

## ูุธุงู ุฅุฏุงุฑุฉ ุงูุชุฑุฌูุงุช ุนุจุฑ API

ูุฐุง ุงูุฏููู ูุดุฑุญ ููููุฉ ุงุณุชุฎุฏุงู API ูุฅุฏุงุฑุฉ ุงูุชุฑุฌูุงุช ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ ูู ุงูุชุทุจูู.

---

## ๐ Endpoints ุงูุนุงูุฉ (ุจุฏูู ูุตุงุฏูุฉ)

### 1. ุงูุญุตูู ุนูู ุงูุชุฑุฌูุงุช ุญุณุจ ุงููุบุฉ
**GET** `/api/translations/{locale}`

ุงุญุตู ุนูู ุฌููุน ุงูุชุฑุฌูุงุช ุจุตูุบุฉ JSON ููุธูุฉ ุญุณุจ ุงููุฌููุนุงุช.

**Parameters:**
- `locale`: `en` ุฃู `ar`

**Example Request:**
```bash
GET /api/translations/ar
```

**Example Response:**
```json
{
  "success": true,
  "data": {
    "common": {
      "appName": "ููุฏูุง ุจุฑู",
      "welcome": "ูุฑุญุจุงู",
      "loading": "ุฌุงุฑู ุงูุชุญููู..."
    },
    "auth": {
      "login": "ุชุณุฌูู ุงูุฏุฎูู",
      "register": "ุฅูุดุงุก ุญุณุงุจ"
    }
  },
  "locale": "ar"
}
```

### 2. ุชุตุฏูุฑ ุงูุชุฑุฌูุงุช ูููู JSON
**GET** `/api/translations/export/{locale}`

ูู ุจุชูุฒูู ููู JSON ูุญุชูู ุนูู ุฌููุน ุงูุชุฑุฌูุงุช.

**Parameters:**
- `locale`: `en` ุฃู `ar`

**Example Request:**
```bash
GET /api/translations/export/ar
```

---

## ๐ Endpoints ุงููุญููุฉ (ุชุชุทูุจ ูุตุงุฏูุฉ Admin/Moderator)

### 3. ุงูุญุตูู ุนูู ุฌููุน ุงูุชุฑุฌูุงุช (ูุน ุงูุชูุงุตูู)
**GET** `/api/translations`

**Headers:**
```
Authorization: Bearer {token}
```

**Query Parameters (ุงุฎุชูุงุฑู):**
- `search`: ุงูุจุญุซ ูู ุงูููุงุชูุญ ูุงูููู
- `group`: ุชุตููุฉ ุญุณุจ ุงููุฌููุนุฉ

**Example Request:**
```bash
GET /api/translations?search=login&group=auth
```

**Example Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "key": "auth.login",
      "value_en": "Login",
      "value_ar": "ุชุณุฌูู ุงูุฏุฎูู",
      "group": "auth",
      "created_at": "2024-01-01T00:00:00.000000Z",
      "updated_at": "2024-01-01T00:00:00.000000Z"
    }
  ],
  "groups": ["common", "auth", "dashboard"]
}
```

### 4. ุฅูุดุงุก ุชุฑุฌูุฉ ุฌุฏูุฏุฉ
**POST** `/api/translations`

**Headers:**
```
Authorization: Bearer {token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "key": "common.newKey",
  "value_en": "New Translation",
  "value_ar": "ุชุฑุฌูุฉ ุฌุฏูุฏุฉ",
  "group": "common"
}
```

**Example Response:**
```json
{
  "success": true,
  "message": "Translation created successfully",
  "data": {
    "id": 123,
    "key": "common.newKey",
    "value_en": "New Translation",
    "value_ar": "ุชุฑุฌูุฉ ุฌุฏูุฏุฉ",
    "group": "common"
  }
}
```

### 5. ุชุญุฏูุซ ุชุฑุฌูุฉ ููุฌูุฏุฉ
**PUT** `/api/translations/{id}`

**Headers:**
```
Authorization: Bearer {token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "key": "common.appName",
  "value_en": "Media Pro",
  "value_ar": "ููุฏูุง ุจุฑู",
  "group": "common"
}
```

**Example Response:**
```json
{
  "success": true,
  "message": "Translation updated successfully",
  "data": {
    "id": 1,
    "key": "common.appName",
    "value_en": "Media Pro",
    "value_ar": "ููุฏูุง ุจุฑู",
    "group": "common"
  }
}
```

### 6. ุญุฐู ุชุฑุฌูุฉ
**DELETE** `/api/translations/{id}`

**Headers:**
```
Authorization: Bearer {token}
```

**Example Response:**
```json
{
  "success": true,
  "message": "Translation deleted successfully"
}
```

### 7. ูุฒุงููุฉ ุงูุชุฑุฌูุงุช ูู ุงูุชุทุจูู
**POST** `/api/translations/sync`

ูู ุจุฑูุน ููู ุงูุชุฑุฌูุงุช ูู ุงูุชุทุจูู (ar.json ุฃู en.json) ููู ุจูุฒุงููุชู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช.

**Headers:**
```
Authorization: Bearer {token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "locale": "ar",
  "translations": {
    "common": {
      "appName": "ููุฏูุง ุจุฑู",
      "welcome": "ูุฑุญุจุงู"
    },
    "auth": {
      "login": "ุชุณุฌูู ุงูุฏุฎูู"
    }
  }
}
```

**Example Response:**
```json
{
  "success": true,
  "message": "Translations synced successfully",
  "stats": {
    "created": 5,
    "updated": 120
  }
}
```

### 8. ุงูุญุตูู ุนูู ุฅุญุตุงุฆูุงุช ุงูุชุฑุฌูุงุช
**GET** `/api/translations/stats`

**Headers:**
```
Authorization: Bearer {token}
```

**Example Response:**
```json
{
  "success": true,
  "data": {
    "total": 1250,
    "groups_count": 25,
    "missing_arabic": 5,
    "missing_english": 2,
    "groups": {
      "common": 50,
      "auth": 30,
      "dashboard": 100
    }
  }
}
```

---

## ๐ฑ ุงุณุชุฎุฏุงู API ูู React Native

### ุชุซุจูุช ุงูููุชุจุงุช
```bash
npm install axios
```

### ุฅูุดุงุก Translation Service

```typescript
// src/services/translationSync.ts
import axios from 'axios';
import AsyncStorage from '@react-native-async-storage/async-storage';

const API_URL = 'https://your-backend.com/api';

export const translationSyncService = {
  // ุงูุญุตูู ุนูู ุงูุชุฑุฌูุงุช ูู ุงูุฎุงุฏู
  async fetchTranslations(locale: 'en' | 'ar') {
    try {
      const response = await axios.get(`${API_URL}/translations/${locale}`);
      if (response.data.success) {
        // ุญูุธ ุงูุชุฑุฌูุงุช ูุญููุงู
        await AsyncStorage.setItem(
          `translations_${locale}`,
          JSON.stringify(response.data.data)
        );
        return response.data.data;
      }
    } catch (error) {
      console.error('Failed to fetch translations:', error);
      // ุงุณุชุฎุฏุงู ุงูุชุฑุฌูุงุช ุงููุญููุฉ ุงููุญููุธุฉ
      const cached = await AsyncStorage.getItem(`translations_${locale}`);
      return cached ? JSON.parse(cached) : null;
    }
  },

  // ุฑูุน ุงูุชุฑุฌูุงุช ุงููุญููุฉ ุฅูู ุงูุฎุงุฏู (ูููุณุคูููู ููุท)
  async syncTranslations(locale: 'en' | 'ar', translations: any) {
    try {
      const token = await AsyncStorage.getItem('auth_token');
      const response = await axios.post(
        `${API_URL}/translations/sync`,
        {
          locale,
          translations
        },
        {
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        }
      );
      return response.data;
    } catch (error) {
      console.error('Failed to sync translations:', error);
      throw error;
    }
  },

  // ุฅูุดุงุก ุชุฑุฌูุฉ ุฌุฏูุฏุฉ
  async createTranslation(data: {
    key: string;
    value_en: string;
    value_ar: string;
    group: string;
  }) {
    try {
      const token = await AsyncStorage.getItem('auth_token');
      const response = await axios.post(
        `${API_URL}/translations`,
        data,
        {
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        }
      );
      return response.data;
    } catch (error) {
      console.error('Failed to create translation:', error);
      throw error;
    }
  },

  // ุชุญุฏูุซ ุชุฑุฌูุฉ
  async updateTranslation(id: number, data: {
    key: string;
    value_en: string;
    value_ar: string;
    group: string;
  }) {
    try {
      const token = await AsyncStorage.getItem('auth_token');
      const response = await axios.put(
        `${API_URL}/translations/${id}`,
        data,
        {
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        }
      );
      return response.data;
    } catch (error) {
      console.error('Failed to update translation:', error);
      throw error;
    }
  }
};
```

### ุงุณุชุฎุฏุงู Translation Service ูู ุงูุชุทุจูู

```typescript
// ูู App.tsx ุฃู ูู useEffect
import { translationSyncService } from './src/services/translationSync';

const App = () => {
  useEffect(() => {
    const loadTranslations = async () => {
      // ุงูุญุตูู ุนูู ุงููุบุฉ ุงููุญููุธุฉ
      const savedLanguage = await AsyncStorage.getItem('@app_language');
      const locale = savedLanguage || 'ar';

      // ุงูุญุตูู ุนูู ุงูุชุฑุฌูุงุช ูู ุงูุฎุงุฏู
      const translations = await translationSyncService.fetchTranslations(locale);

      if (translations) {
        // ุชุญุฏูุซ i18n ุจุงูุชุฑุฌูุงุช ุงูุฌุฏูุฏุฉ
        i18n.addResourceBundle(locale, 'translation', translations, true, true);
      }
    };

    loadTranslations();
  }, []);

  return <YourApp />;
};
```

---

## ๐ ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### 1. ุชุญุฏูุซ ุงูุชุฑุฌูุงุช ุชููุงุฆูุงู ุนูุฏ ุจุฏุก ุงูุชุทุจูู
```typescript
// ุนูุฏ ูุชุญ ุงูุชุทุจููุ ุงุญุตู ุนูู ุฃุญุฏุซ ุงูุชุฑุฌูุงุช ูู ุงูุฎุงุฏู
const translations = await translationSyncService.fetchTranslations('ar');
i18n.addResourceBundle('ar', 'translation', translations, true, true);
```

### 2. ุฅุฏุงุฑุฉ ุงูุชุฑุฌูุงุช ูู ุฏุงุฎู ุงูุชุทุจูู (ูููุณุคูููู)
```typescript
// ุฅูุดุงุก ุชุฑุฌูุฉ ุฌุฏูุฏุฉ
await translationSyncService.createTranslation({
  key: 'settings.newFeature',
  value_en: 'New Feature',
  value_ar: 'ููุฒุฉ ุฌุฏูุฏุฉ',
  group: 'settings'
});

// ุชุญุฏูุซ ุชุฑุฌูุฉ ููุฌูุฏุฉ
await translationSyncService.updateTranslation(123, {
  key: 'common.appName',
  value_en: 'Media Pro',
  value_ar: 'ููุฏูุง ุจุฑู',
  group: 'common'
});
```

### 3. ูุฒุงููุฉ ููู ุงูุชุฑุฌูุงุช ุงููุญูู ูุน ุงูุฎุงุฏู
```typescript
import arTranslations from './src/locales/ar.json';

await translationSyncService.syncTranslations('ar', arTranslations);
```

---

## ๐ฏ ุฃูุถู ุงูููุงุฑุณุงุช

1. **ุงูุชุฎุฒูู ุงููุคูุช (Caching)**
   - ุงุญูุธ ุงูุชุฑุฌูุงุช ูุญููุงู ูู AsyncStorage
   - ุงุณุชุฎุฏู ุงูุชุฑุฌูุงุช ุงููุญููุธุฉ ุฅุฐุง ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู

2. **ุงูุชุญุฏูุซ ุงูุชููุงุฆู**
   - ุงูุญุต ุงูุชุฑุฌูุงุช ุงูุฌุฏูุฏุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู
   - ุงุณุชุฎุฏู versioning ููุชุญูู ูู ุงูุญุงุฌุฉ ููุชุญุฏูุซ

3. **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**
   - ุงุณุชุฎุฏู try-catch ูู ุฌููุน ุทูุจุงุช API
   - ุนุฑุถ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู

4. **ุงูุฃูุงู**
   - ุชุฃูุฏ ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู ูุจู ุงูุณูุงุญ ุจุงูุชุนุฏูู
   - ุงุณุชุฎุฏู HTTPS ููุท
   - ูุง ุชุฎุฒู tokens ูู ุฃูุงูู ุบูุฑ ุขููุฉ

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ 401 (Unauthorized)
```json
{
  "message": "Unauthenticated."
}
```
**ุงูุญู:** ุชุฃูุฏ ูู ุฅุฑุณุงู Bearer token ุตุญูุญ ูู header

### ุฎุทุฃ 422 (Validation Error)
```json
{
  "success": false,
  "message": "Validation failed",
  "errors": {
    "key": ["The key has already been taken."]
  }
}
```
**ุงูุญู:** ุชุญูู ูู ุงูุจูุงูุงุช ุงููุฑุณูุฉ ูุงูุชุฃูุฏ ูู ุนุฏู ุชูุฑุงุฑ ุงูููุงุชูุญ

### ุฎุทุฃ 403 (Forbidden)
```json
{
  "message": "This action is unauthorized."
}
```
**ุงูุญู:** ุชุฃูุฏ ูู ุฃู ุงููุณุชุฎุฏู ูุฏูู ุตูุงุญูุฉ admin ุฃู moderator

---

## ๐ ุงูุฏุนู

ูููุฒูุฏ ูู ุงููุนูููุงุชุ ุฑุงุฌุน:
- `TRANSLATION_SYSTEM_SETUP.md` - ุฅุนุฏุงุฏ ุงููุธุงู
- `TRANSLATION_QUICK_START.md` - ุฏููู ุงูุจุฏุงูุฉ ุงูุณุฑูุนุฉ
- `API_DOCUMENTATION.md` - ุชูุซูู API ุงููุงูู

---

**ููุงุญุธุฉ:** ุชุฃูุฏ ูู ุชุดุบูู migrations ูุจู ุงุณุชุฎุฏุงู API:
```bash
php artisan migrate
php artisan db:seed --class=TranslationSeeder
```
