# ๐ ุฅุนุฏุงุฏ Git Auto Deployment ูู Plesk

## ุงููุฒุงูุง โจ
- ุชุนุฏู ุนูู ุงูููุฏ ูู ุฌูุงุฒู
- `git push` ูุชููุงุฆูุงู ูุฑูุน ุนูู ุงูุณูุฑูุฑ
- Laravel commands ุชุดุชุบู ุชููุงุฆูุงู
- Cache ูุชุญุฏุซ ุชููุงุฆูุงู

---

## ุงูุฎุทูุงุช ุงููุงููุฉ

### 1๏ธโฃ ุฅูุดุงุก GitHub Repository

#### ุนูู GitHub:

1. ุงุฐูุจ ุฅูู: https://github.com/new
2. ุงุณู ุงูู Repository: `mediapro-backend`
3. ุงุฎุชุฑ: **Private** (ููุฃูุงู)
4. ุงุถุบุท **Create repository**

---

### 2๏ธโฃ ุฑุจุท ุงููุดุฑูุน ุจู Git (ุนูู ุฌูุงุฒู)

ูู ูุฌูุฏ ุงูุจุงู ุงูุฏุ ุดุบูู ูู Terminal:

```bash
cd c:\Users\HP\Desktop\social-media-app\SocialMediaManager\backend-laravel

# Initialize Git (ุฅุฐุง ูู ููู ููุฌูุฏ)
git init

# Add all files
git add .

# First commit
git commit -m "Initial commit: MediaPro Laravel Backend"

# Add GitHub remote
git remote add origin https://github.com/YOUR_USERNAME/mediapro-backend.git

# Push to GitHub
git branch -M main
git push -u origin main
```

**ููุงุญุธุฉ:** ุงุณุชุจุฏู `YOUR_USERNAME` ุจุงุณู ูุณุชุฎุฏู GitHub

---

### 3๏ธโฃ ุฅุนุฏุงุฏ Git ูู Plesk

#### ูู Plesk Panel:

1. **Websites & Domains** โ **mediapro.social**

2. ุงุจุญุซ ุนู **Git** ุฃู **Git for Websites**

3. **Add Repository** ุฃู **Connect Repository**

4. **ุงููุฃ ุงูุจูุงูุงุช:**
   ```
   Repository URL: https://github.com/YOUR_USERNAME/mediapro-backend.git
   Repository path: /httpdocs
   Branch: main
   ```

5. **Authentication:**
   - ุฅุฐุง Repository ุฎุงุตุ ุฃุถู SSH Key ุฃู Personal Access Token

---

### 4๏ธโฃ ุชุนุฏูู Deployment Settings ูู Plesk

#### ูู ุตูุญุฉ Git ูู Plesk:

**1. Deployment Mode:**
   - โ ุงุฎุชุฑ **Automatic** (ููู!)
   - ูุฐุง ูุฎูู ูู push ูุฑูุน ุชููุงุฆูุงู

**2. Deployment Script:**
   - ุงุถุบุท **Edit script**
   - ุงุญุฐู ุงูุณูุฑูุจุช ุงูููุฌูุฏ
   - ุงูุณุฎ ุงูุณูุฑูุจุช ุงูุชุงูู:

```bash
#!/bin/bash

# MediaPro - Laravel Deployment Script
set -e

echo "Starting MediaPro deployment..."

# Navigate to project
cd /var/www/vhosts/mediapro.social/httpdocs

# Install Composer dependencies
echo "[1/7] Installing dependencies..."
composer install --no-dev --no-interaction --prefer-dist --optimize-autoloader

# Setup environment
echo "[2/7] Checking .env..."
if [ ! -f ".env" ]; then
    if [ -f ".env.server" ]; then
        cp .env.server .env
        echo "Created .env from .env.server"
    fi
fi

# Clear caches
echo "[3/7] Clearing caches..."
php artisan config:clear
php artisan cache:clear
php artisan route:clear
php artisan view:clear

# Run migrations
echo "[4/7] Running migrations..."
php artisan migrate --force

# Build caches
echo "[5/7] Building caches..."
php artisan config:cache
php artisan route:cache
php artisan view:cache

# Storage link
echo "[6/7] Storage link..."
php artisan storage:link || true

# Fix permissions
echo "[7/7] Fixing permissions..."
chmod -R 775 storage bootstrap/cache
chown -R $USER:psacln storage bootstrap/cache || true

echo "โ Deployment complete!"
echo "Time: $(date)"
```

   - ุงุถุบุท **Save** ุฃู **OK**

**3. Deployment Steps:**
   ุชุฃูุฏ ูู ุชูุนูู ูุฐู ุงูุฎุทูุงุช:
   - โ Fetch source code
   - โ Deploy source code from Git
   - โ Install composer.json dependencies
   - โ Run deployment script
   - โฌ Enable/Disable maintenance mode (ุงุฎุชูุงุฑู)
   - โฌ Install package.json dependencies (ุบูุฑ ูุทููุจ ููู API)

**4. ุงุถุบุท Submit**

---

### 5๏ธโฃ ุฅุนุฏุงุฏ GitHub Webhook (ููู Auto Deploy)

#### ูู GitHub Repository:

1. ุงุฐูุจ ุฅูู: **Settings** โ **Webhooks**

2. **Add webhook**

3. **Payload URL:**
   ```
   https://65-159-66-148.host.secureserver.net:8443/modules/git/public/web-hook.php?uuid=16a7feec-5a60-224d-2881-8bb9e4e5607d
   ```
   (ูุฐุง ุงูุฑุงุจุท ุงููู ุดูุชู ูู Plesk)

4. **Content type:**
   - `application/json`

5. **Which events:**
   - โ Just the push event

6. **Active:**
   - โ ุชุฃูุฏ ุฃูู ููุนูู

7. **Add webhook**

---

### 6๏ธโฃ ุงุฎุชุจุงุฑ Auto Deployment

#### ุนูู ุฌูุงุฒู:

1. **ุนุฏูู ุฃู ููู (ุงุฎุชุจุงุฑ):**
   ```bash
   cd c:\Users\HP\Desktop\social-media-app\SocialMediaManager\backend-laravel

   echo "// Test auto deployment" >> routes/api.php
   ```

2. **Commit ู Push:**
   ```bash
   git add .
   git commit -m "Test: Auto deployment"
   git push origin main
   ```

3. **ุฑุงูุจ Plesk:**
   - ูู ุตูุญุฉ Git ูู Plesk
   - ุฑุงุญ ุชุดูู **Deployment Status**
   - ุฑุงุญ ูุจุฏุฃ Deploy ุชููุงุฆูุงู!

4. **ุชุญูู ูู ุงููููุน:**
   ```
   https://mediapro.social/api/config
   ```

---

## ๐ฏ ุณูุฑ ุงูุนูู ุงููููู (Workflow)

ุจุนุฏ ุงูุฅุนุฏุงุฏุ ูู ูุง ุชุจู ุชุนุฏู:

```bash
# 1. ุนุฏูู ุงููููุงุช ูู VS Code ุฃู ุฃู ูุญุฑุฑ
# 2. ูู Terminal:

cd c:\Users\HP\Desktop\social-media-app\SocialMediaManager\backend-laravel

# 3. Add changes
git add .

# 4. Commit with message
git commit -m "ูุตู ุงูุชุนุฏูู"

# 5. Push (ููุง ูุตูุฑ Auto Deploy!)
git push origin main

# 6. ุงูุชุธุฑ 10-30 ุซุงููุฉ
# 7. ุงูุชุญ ุงููููุน - ุงูุชุนุฏููุงุช ููุฌูุฏุฉ!
```

---

## ๐ง ุฅุฐุง ูุงุฌูุช ูุดุงูู

### ุงููุดููุฉ: Deployment ูุดู

**ุงูุญู:**
1. ุงูุชุญ ุตูุญุฉ Git ูู Plesk
2. ุงุถุบุท **Deploy** ูุฏููุงู
3. ุดูู ุงูู Logs - ุฑุงุญ ูุนุฑุถ ุงูุฎุทุฃ
4. ุฃุฑุณู ูู ุงูู Error

---

### ุงููุดููุฉ: Webhook ูุง ูุดุชุบู

**ุงูุญู:**
1. ูู GitHub โ Settings โ Webhooks
2. ุงุถุบุท ุนูู ุงูู Webhook
3. ุดูู **Recent Deliveries**
4. ุฅุฐุง ูู ุฃุฎุทุงุกุ ุชุฃูุฏ ูู ุงูุฑุงุจุท ุตุญูุญ

---

### ุงููุดููุฉ: Permission denied

**ุงูุญู:**
ุดุบูู ุนุจุฑ SSH:
```bash
cd /var/www/vhosts/mediapro.social/httpdocs
chmod -R 775 storage bootstrap/cache
chown -R $USER:psacln storage bootstrap/cache
```

---

## ๐ ูููุงุช ูุฌุจ ุฅุถุงูุชูุง ูู .gitignore

ุชุฃูุฏ ูู ุฃู ูุฐู ุงููููุงุช **ูุง** ุชุฑูุน ุนูู Git:

```
.env
.env.backup.*
vendor/
node_modules/
storage/*.key
.phpunit.result.cache
storage/logs/*.log
storage/framework/cache/*
storage/framework/sessions/*
storage/framework/views/*
public/storage
```

ููู [.gitignore](SocialMediaManager/backend-laravel/.gitignore) ููุฌูุฏ ุจุงููุนู.

---

## โ๏ธ ุฅุนุฏุงุฏุงุช ูุชูุฏูุฉ

### Auto-rollback ุนูุฏ ุงููุดู:

ุฃุถู ูุฐุง ูู ุจุฏุงูุฉ ุงูู Deployment Script:

```bash
#!/bin/bash
set -e  # Exit on error

# Backup current state
BACKUP_DIR="/var/www/vhosts/mediapro.social/backups"
mkdir -p $BACKUP_DIR
tar -czf $BACKUP_DIR/backup-$(date +%Y%m%d-%H%M%S).tar.gz \
    --exclude='vendor' \
    --exclude='node_modules' \
    --exclude='storage/logs' \
    /var/www/vhosts/mediapro.social/httpdocs

# Continue with deployment...
```

---

### Notifications ุนูู Discord/Slack:

ุฃุถู ูู ููุงูุฉ ุงูุณูุฑูุจุช:

```bash
# Send notification
curl -X POST -H 'Content-type: application/json' \
--data '{"text":"โ MediaPro deployed successfully!"}' \
YOUR_WEBHOOK_URL
```

---

## ๐ ูุฑุงูุจุฉ Deployments

ูู Pleskุ ุตูุญุฉ Git:
- **Deployment History** - ุชุดูู ูู ุงูู deployments
- **Logs** - ุชุดูู ุชูุงุตูู ูู deployment
- **Status** - ูู ูุฌุญ ุฃู ูุดู

---

## ๐ฏ ุงูุฎูุงุตุฉ

ุจุนุฏ ุงูุฅุนุฏุงุฏ:
1. โ ุชุนุฏู ุนูู ุฌูุงุฒู
2. โ `git push` ููุท
3. โ ูู ุดู ูุฑูุน ุชููุงุฆูุงู
4. โ Laravel commands ุชุดุชุบู ุชููุงุฆูุงู
5. โ ุงููููุน ูุชุญุฏุซ ููุฑุงู

**ูุง ุชุญุชุงุฌ:**
- โ FTP/SFTP
- โ ุฑูุน ูุฏูู
- โ SSH commands ูู ูุฑุฉ
- โ ูุณุญ Cache ูุฏููุงู

---

## ๐ ุฅุฐุง ุงุญุชุฌุช ูุณุงุนุฏุฉ

ุฃุฑุณู ูู:
1. ููุทุฉ ุดุงุดุฉ ูู ุตูุญุฉ Git ูู Plesk
2. Deployment Logs (ุฅุฐุง ูู ุฎุทุฃ)
3. GitHub Webhook Delivery logs

---

**ุงุจุฏุฃ ุงูุขู ุจุงูุฎุทูุฉ 1๏ธโฃ!** ๐
